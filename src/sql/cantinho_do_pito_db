CREATE DATABASE cantinho_do_pito_db;
USE cantinho_do_pito_db;

CREATE TABLE States (
	ID INTEGER AUTO_INCREMENT NOT NULL,
	name VARCHAR(255) NOT NULL,
	UF CHAR(2) NOT NULL,
	CONSTRAINT PK_States PRIMARY KEY (ID)
);

CREATE TABLE Cities (
	ID INTEGER AUTO_INCREMENT NOT NULL,
	name VARCHAR(255) NOT NULL,
	state_id INTEGER NOT NULL,
	CONSTRAINT PK_Cities PRIMARY KEY (ID),
	CONSTRAINT FK_States_Cities FOREIGN KEY (state_id) REFERENCES States(ID)
);

CREATE TABLE Address (
	ID INTEGER AUTO_INCREMENT NOT NULL,
	address VARCHAR(255) NOT NULL,
	zipcode VARCHAR(20) NOT NULL,
	complement VARCHAR(255),
	district VARCHAR(255),
	city_id INTEGER NOT NULL,
	CONSTRAINT PK_Address PRIMARY KEY (ID),
	CONSTRAINT FK_Cities_Address FOREIGN KEY (city_id) REFERENCES Cities(ID)
);

CREATE TABLE Clients (
	ID INTEGER AUTO_INCREMENT NOT NULL,
	email VARCHAR(255) NOT NULL,
	name VARCHAR(255) NOT NULL,
	password VARCHAR(255) NOT NULL,
	birthday DATE,
	address VARCHAR(255) NOT NULL,
	zipcode VARCHAR(20) NOT NULL,
	complement VARCHAR(255),
	district VARCHAR(255),
	city_id INTEGER NOT NULL,
	CONSTRAINT PK_Clients PRIMARY KEY (ID),
	CONSTRAINT FK_Cities_Clients FOREIGN KEY (city_id) REFERENCES Cities(ID)
);

CREATE TABLE Categories (
	ID INTEGER AUTO_INCREMENT NOT NULL,
    name VARCHAR(255) NOT NULL,
	description VARCHAR(255) NOT NULL,
	CONSTRAINT PK_Products PRIMARY KEY (ID)
);

CREATE TABLE Products (
	ID INTEGER AUTO_INCREMENT NOT NULL,
	name VARCHAR(255) NOT NULL,
    description VARCHAR(255) NOT NULL,
    price DECIMAL(7,2) NOT NULL,
    stock INTEGER NOT NULL,
    image VARCHAR(255) NOT NULL,
    category_id INTEGER NOT NULL,
	CONSTRAINT PK_Products PRIMARY KEY (ID),
	CONSTRAINT FK_Categories_Products FOREIGN KEY (category_id) REFERENCES Categories(ID)
);

CREATE TABLE Buy (
	ID INTEGER AUTO_INCREMENT NOT NULL,
    aumount INTEGER NOT NULL,
    date DATE NOT NULL,
	client_id INTEGER NOT NULL,
	address_id INTEGER NOT NULL,
    product_id INTEGER,
	CONSTRAINT PK_Buy PRIMARY KEY (ID),
	CONSTRAINT FK_Clients_Buy FOREIGN KEY (client_id) REFERENCES Clients(ID),
  	CONSTRAINT FK_Clients_Address FOREIGN KEY (address_id) REFERENCES Address(ID),
	CONSTRAINT FK_Clients_Products FOREIGN KEY (product_id) REFERENCES Products(ID)
);